language: python
sudo: false
python:
- '3.4'
- '3.5'
before_install:
- wget https://repo.continuum.io/miniconda/Miniconda3-latest-Linux-x86_64.sh -O miniconda.sh;
- chmod +x miniconda.sh
- "./miniconda.sh -b -p /home/travis/mc"
- export PATH=/home/travis/mc/bin:$PATH
install:
- export GIT_FULL_HASH=`git rev-parse HEAD`
- conda config --set always_yes true
- conda update conda
- conda create -n testenv pip python=$TRAVIS_PYTHON_VERSION six "numpy<1.10" pandas
  h5py coverage jsonschema jinja2 sphinx
- source activate testenv
- conda install -n testenv pyyaml ipywidgets
- conda config --add channels lightsource2
- conda install mongoengine tzlocal prettytable boltons pymongo=2.9 pims tifffile
- conda install databroker
- conda config --add channels bokeh
- conda install sphinx-bootstrap-theme
- pip install coveralls
- pip install codecov
- pip install travis-sphinx
- python setup.py install
script:
- coverage run --source=csxtools setup.py test
- cd $TRAVIS_BUILD_DIR/docs
- make html
- cd $TRAVIS_BUILD_DIR
after_success:
- coveralls
- codecov
- cd $TRAVIS_BUILD_DIR/docs
- git config credential.helper store --file=$HOME/.git-credentials
- echo "https://stuwilkins:${GH_TOKEN}@github.com" > $HOME/.git-credentials
- echo $GH_TOKEN
- git config --global user.email "stuwilkins@travis.ci"
- git config --global user.name "stuwilkins"
- git config --get remote.origin.url
- make gh-pages
env:
  global:
    secure: ad3sPV1BhnXXxk0rc3M+1NMBEPcKEIPw3v3ZqSeQQbxqzEP1ZYs08UaLLwbbgf7gjXqeQOfrhR0r4FxMFU8Q9YN3D18CDi7T1gkEByze1krDhSoawIU+XxypHWP3Osh0qhWMXBF7+g1BnFOFTP8OBJp7ZRSxy6ssNIg1HmzVHzYEtNOSqTjhtj++zJT+wzuXr69QZfyNmRxxKnbLkL9pnG+0z73DdTc8Hs3b2z5bWUnMwLMdciWJbNEwdM/fsU6/Rb4MjImHRCm7T3Zc0HJjzQY6yXjM+57ps8wDl4yiF0l+7dVWsRW6s3UE6W/vMrOcGpuEV5mG9RMk8zRfL85au5YEMp6sQyQzwjuOM2MH4E01OAfQzkcSPCe8FadqQ2Ac2eRjzJEAa/q7lOsiHLJoJ/x7VRd7kqY8LjWGe4xyTzCJk8C52uChgLsRHxtNUJbrEEoOXK+46LmoeG0q4bFIDZsm7nc2VcC9bYGLSjKI9QGa8FbvsdTg5af9WWJIQkLX3qBF+Mkzu9W+f+Wb5/itL6OGpfXR0zzmj9sBIzYARx9f0M7Ntp5Bty369cmHNgkAOfr2TBiXfoRRlkZTVr+KDyncEmKhdqeUy5lBnqAJHPP4VU3mmXJGU+uwINGz4ibLolz/+i80AoK6Z+dN6NzaT52Y4wO5IyNjUycOqrMGJ1I=
