language: python
sudo: false
python:
- '3.4'
- '3.5'
before_install:
- wget https://repo.continuum.io/miniconda/Miniconda3-latest-Linux-x86_64.sh -O miniconda.sh;
- chmod +x miniconda.sh
- "./miniconda.sh -b -p /home/travis/mc"
- export PATH=/home/travis/mc/bin:$PATH
install:
- export GIT_FULL_HASH=`git rev-parse HEAD`
- conda config --set always_yes true
- conda update conda
- conda create -n testenv pip python=$TRAVIS_PYTHON_VERSION six "numpy<1.10" pandas
  h5py coverage jsonschema jinja2 sphinx
- source activate testenv
- conda install -n testenv pyyaml ipywidgets
- conda config --add channels lightsource2
- conda install mongoengine tzlocal prettytable boltons pymongo=2.9 pims tifffile
- conda install databroker
- conda config --add channels bokeh
- conda install sphinx-bootstrap-theme
- pip install coveralls
- pip install codecov
- pip install travis-sphinx
- python setup.py install
script:
- coverage run --source=csxtools setup.py test
- cd $TRAVIS_BUILD_DIR/docs
- make html
- cd $TRAVIS_BUILD_DIR
after_success:
- coveralls
- codecov
- cd $TRAVIS_BUILD_DIR/docs
- git config credential.helper store --file=$HOME/.git-credentials
- echo "https://stuwilkins:${GH_TOKEN}@github.com" > $HOME/.git-credentials
- echo $GH_TOKEN
- git config --global user.email "stuwilkins@travis.ci"
- git config --global user.name "stuwilkins"
- git config --get remote.origin.url
- make gh-pages
env:
  global:
    secure: hIZ4ZUT0mGDKDbHXnunCvnuOeNKAGoKJSlWqun/Vo7CLaPfceigab9EWfzJE/iHHwfhapSwKBYXrJvplGe0vL7AgwjpQ2P6p7qQc/y/2XySxqICIT0WdAll3rJtnVBrHx9mn36TUn+3nGUned6dWIheLCOLOVaMjJtfYMdkHvDFUiuhIlRvTXo2SYEN+dZrSSpDiJDh1+J3lkg2zDUkL/CP+KRhpI3m/OjIDdJHvAdrLn+dB/gFoobrcxOWJGzkMoLHuLnc64lM4oq96jbGXbPyNcaQxr9TbqfVTypDcTpw9HfJNR6yKck1cBdqyxSVqQs/BNWDEoqjDevee+xQgekXjCxDbqpqnXUh9G6FY0543hcxQcMdpUPXDFkpt+N06m/Kseiiom9pJLGY7OstNgpc0Sl5O/aDhajY6eggFVjX4sc3MlbTwAc1EXBxaRfKaIijsnytsPMWundSae9XCV7zNIkOY4kCd9SfsiJwOhRO8b0b5tuHdywZKXrHSe+NUGbXwESPSmV60gjLNi7U4bN6MIfZ7KPCdr/tAmxG4/YEwSxE3uPrhmaSop/IvZpo6sqU+3tkQPvlOJMkGdqvHSUj6PZWzFWSGtQAQtgZasalEKIpshSwaYtUoU0o36J5cg5lMYA+FS8dp/WSc2PF6lAtmNOk7D2CvBjA67DjHIkk=
