language: python
sudo: false
python:
- '3.4'
- '3.5'
before_install:
- wget https://repo.continuum.io/miniconda/Miniconda3-latest-Linux-x86_64.sh -O miniconda.sh;
- chmod +x miniconda.sh
- "./miniconda.sh -b -p /home/travis/mc"
- export PATH=/home/travis/mc/bin:$PATH
install:
- export GIT_FULL_HASH=`git rev-parse HEAD`
- conda config --set always_yes true
- conda update conda
- conda create -n testenv pip python=$TRAVIS_PYTHON_VERSION six "numpy<1.10" pandas
  h5py coverage jsonschema jinja2 sphinx
- source activate testenv
- conda install -n testenv pyyaml ipywidgets
- conda config --add channels lightsource2
- conda install mongoengine tzlocal prettytable boltons pymongo=2.9 pims tifffile
- conda install databroker
- conda config --add channels bokeh
- conda install sphinx-bootstrap-theme
- pip install coveralls
- pip install codecov
- pip install travis-sphinx
- python setup.py install
script:
- coverage run --source=csxtools setup.py test
- cd $TRAVIS_BUILD_DIR/docs
- make html
- cd $TRAVIS_BUILD_DIR
after_success:
- coveralls
- codecov
- cd $TRAVIS_BUILD_DIR/docs
- git config credential.helper store --file=$HOME/.git-credentials
- echo "https://stuwilkins:${GH_TOKEN}@github.com" > $HOME/.git-credentials
- echo $GH_TOKEN
- git config --global user.email "stuwilkins@travis.ci"
- git config --global user.name "stuwilkins"
- git config --get remote.origin.url
- make gh-pages
env:
  global:
  - secure: FLlUO263fn7uo4T0xzRmk5Aha3wyBJSucyxD8dzsjzW7JMQZy9OFaul6p2ImAUiYwOGVPG8oOEKZSRQTVXxsBpdm3XZyzJP6OjI3Tc+CB1Heiw1itwLcxRm9b7Ee1wvnsXyljjPhoDRiO9lytZ9njy4gpHeALRDXGdwq0FvFcyeQhv49iKxW5UR4I8x5iwYMrSWZmUM9Nak77Ccn+tHwDScitCktQbUzs7m3VslvcgZaluaSRVSuH/YKMYX7IolphU9NkMZ9v0FkQDo7gVer2cFuwPHWIM48hHF19IlV6P9/Z9P3E4RR90JIFV7vIE+NQ2+Cxb1lh5Vi+eXAI5I4aQP6+/mKlkisLwyFYLxjnHG3bQ0vc0eXuuzexKkG/uaZpQ+P7gSAmv3EpHEt9H7DXrOuWPjbRucUE+rFVrnfemrR0ASf4ghD1APZTDOaju7Cxyb6OVJiw38Q0UkkXoz+CTAvS//1fdhrG91q9qesIx1OeBmwQF4aLFcQ4mH+MY9X80hTPG/WmPPwTay6P/nCw1ljVwQzgKx+KS3UczHt6dh4Fl/w8wLcQKZvStN6FCa72N1HxKqGO0Wn23OZOTR3+b7HLPwDzeE+sp+GsX2QqR5NsXmzyum2r4C2vhQBqVROJ0uztea3mY4JvWGdNdttnzmJuhQ1/Jhij2HM8QQ1nXQ=
